# Example values for Minikube/development environment
# Usage: helm install vm-x-ai ./helm/vm-x-ai -f values-minikube.yaml

# Use libsodium for encryption (suitable for local development)
# Use smaller resource requests for Minikube
api:
  encryption:
    provider: libsodium  # libsodium is fine for local testing
  env:
    # Avoid conflicts with Next.js API routes when both are deployed to same host
    BASE_PATH: "/_api"
  replicaCount: 1
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi

ui:
  replicaCount: 1
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env:
    NEXT_AUTH_DEBUG: "true"

redis:
  mode: single

otel:
  enabled: true
  collector:
    enabled: true
  jaeger:
    enabled: true
  prometheus:
    enabled: true
  loki:
    enabled: true
  grafana:
    enabled: true

ingress:
  enabled: true

  istio:
    # Gateway configuration
    gateway:
      name: vm-x-ai-gateway
      namespace: istio-system  # Usually deployed in istio-system
      selector:
        istio: ingressgateway
      servers:
        - port:
            number: 80
            name: http
            protocol: HTTP
          hosts:
            - vm-x-ai.local
    
    # VirtualService configuration
    virtualService:
      hosts:
        - vm-x-ai.local
      gateways:
        - istio-system/vm-x-ai-gateway
    
    # Enable internal DNS resolution for cluster-internal access
    internalDns:
      enabled: true
      gatewayService: istio-ingressgateway.istio-system.svc.cluster.local
      port: 80
